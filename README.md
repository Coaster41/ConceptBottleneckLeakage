# Concept Bottleneck with Leakage Loss
This repository implements a basic Concept Bottleneck Model with experiments for latent concept loss functions. The repo was built to be highly customizable through config files. The config files determine everything from where to the data is located to model parameters and loss functions. To view all config parameters see `run_cbm.py`. The only required parameters for a vanilla CBM are `expr_name`, `data_loc`, `x_headers`, `c_headers`, and `y_headers`.

## Running the Model
The main script to run the model is `run_cbm.py`. By default the script trains a model from scratch, but can instead run only the evaluator if given pretrained model waits via a `.pkl` file using the `--load_model` argument. Example JSON config files can be found under the `configs/` folder which can be loaded into the cbm script using the required `--config` argument. To train and test the model, any tabular dataset can be used if it is saved as a `.csv` file with a header that contains column names. For data preprocessing, the first column is the index and the last row is dropped. When a model is trained, a `.pkl` file containing the model weights is saved alongside the config file used and a graph of loss and accuracy. By default this is saved as an experiment under the `checkpoints` folder, but this can be configured in the config file. Note that the experiment folder is named `{expr_name}_{git_commit_hash}`